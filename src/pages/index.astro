---
import { getCollection } from 'astro:content';
import SEOLayout from '../layouts/SEOLayout.astro';
import Nav from '../components/Nav.astro';
import Hero from '../components/Hero.astro';
import Button from '../components/Button.astro';
import Card from '../components/Card.astro';
import Section from '../components/Section.astro';
import Footer from '../components/Footer.astro';

// Pobierz najnowsze wpisy
const blogPosts = await getCollection('blog', ({ data }) => data.draft !== true);
const portfolioItems = await getCollection('portfolio');
const pages = await getCollection('pages');

const latestBlog = blogPosts.sort((a, b) =>
  b.data.publishDate.getTime() - a.data.publishDate.getTime()
).slice(0, 3);

const featuredPortfolio = portfolioItems
  .filter(item => item.data.featured)
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 3);
---

<SEOLayout
  title="CMDX - Portfolio Grafika i Design"
  description="Witaj w moim portfolio! Znajdziesz tutaj moje projekty graficzne, artykuły o designie i inspiracje."
  keywords={['portfolio', 'grafika', 'design', 'blog', 'projekty']}
>
  <Nav />

  <Hero
    title="Tworzę Design, Który Inspiruje"
    subtitle="Grafik i designer specjalizujący się w brandingu, UI/UX i projektowaniu graficznym"
  >
    <Button href="/portfolio" variant="primary" size="lg">
      Zobacz Portfolio
    </Button>
    <Button href="/blog" variant="outline" size="lg">
      Czytaj Blog
    </Button>
  </Hero>

  <!-- Featured Projects -->
  {featuredPortfolio.length > 0 && (
    <Section
      title="Wyróżnione Projekty"
      subtitle="Moje najlepsze realizacje dla klientów"
      background="white"
    >
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {featuredPortfolio.map((item) => (
          <Card
            href={`/portfolio/${item.slug}`}
            title={item.data.title}
            description={item.data.description}
            image="https://images.unsplash.com/photo-1561070791-2526d30994b5?w=800&h=600&fit=crop"
            imageAlt={item.data.title}
            tags={item.data.tags.slice(0, 3)}
            featured={true}
          />
        ))}
      </div>
      <div class="text-center mt-12">
        <Button href="/portfolio" variant="primary">
          Zobacz Wszystkie Projekty →
        </Button>
      </div>
    </Section>
  )}

  <!-- What I Do -->
  <Section
    title="Co Robię?"
    subtitle="Moje specjalizacje i usługi"
    background="gray"
  >
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg hover:shadow-xl transition-shadow">
        <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mb-6">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
          </svg>
        </div>
        <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-3">Branding & Logo</h3>
        <p class="text-gray-600 dark:text-gray-300">
          Tworzę unikalne identyfikacje wizualne, które budują rozpoznawalność marki i zapadają w pamięć.
        </p>
      </div>

      <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg hover:shadow-xl transition-shadow">
        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center mb-6">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
          </svg>
        </div>
        <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-3">UI/UX Design</h3>
        <p class="text-gray-600 dark:text-gray-300">
          Projektuję intuicyjne interfejsy użytkownika, które łączą estetykę z funkcjonalnością.
        </p>
      </div>

      <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg hover:shadow-xl transition-shadow">
        <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl flex items-center justify-center mb-6">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
        </div>
        <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-3">Grafika</h3>
        <p class="text-gray-600 dark:text-gray-300">
          Od materiałów marketingowych po projekty digital - kompleksowa obsługa graficzna.
        </p>
      </div>
    </div>
  </Section>

  <!-- Latest Blog Posts -->
  {latestBlog.length > 0 && (
    <Section
      title="Najnowsze z Bloga"
      subtitle="Artykuły, poradniki i inspiracje ze świata designu"
      background="white"
    >
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {latestBlog.map((post) => (
          <Card
            href={`/blog/${post.slug}`}
            title={post.data.title}
            description={post.data.description}
            image="https://images.unsplash.com/photo-1499750310107-5fef28a66643?w=800&h=600&fit=crop"
            imageAlt={post.data.title}
            date={post.data.publishDate.toLocaleDateString('pl-PL', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
            tags={post.data.tags.slice(0, 2)}
          />
        ))}
      </div>
      <div class="text-center mt-12">
        <Button href="/blog" variant="secondary">
          Więcej Artykułów →
        </Button>
      </div>
    </Section>
  )}

  <!-- CTA Section -->
  <Section background="gradient">
    <div class="text-center max-w-3xl mx-auto">
      <h2 class="text-4xl font-bold text-gray-900 dark:text-white mb-6">
        Gotowy na Współpracę?
      </h2>
      <p class="text-xl text-gray-600 dark:text-gray-300 mb-8">
        Szukasz designera do swojego projektu? Skontaktuj się ze mną, aby omówić szczegóły.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <Button href="mailto:kontakt@cmdx.pl" variant="primary" size="lg">
          Napisz do Mnie
        </Button>
        <Button href="/portfolio" variant="outline" size="lg">
          Zobacz Portfolio
        </Button>
      </div>
    </div>
  </Section>

  <Footer />
</SEOLayout>
